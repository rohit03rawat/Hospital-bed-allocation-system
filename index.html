<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Keep your existing head content -->
  <title>Smart Bed Allocation System - Patient Entry</title>
  <!-- CSS remains the same -->
</head>
<body>
  <div class="container">
    <!-- Keep your existing header and form structure -->
    
    <div class="form-container">
      <h2 class="form-title">Patient Information</h2>
      
      <form id="patient-form">
        <!-- Keep all your existing form fields -->
        
        <button type="submit" id="submit-btn" class="submit-btn">
          <span class="loading" id="loading"></span>
          Allocate Bed
        </button>
      </form>
      
      <div class="form-footer">
        <p>Fields marked with * are mandatory</p>
      </div>
    </div>
  </div>

  <script>
    document.getElementById('patient-form').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const loading = document.getElementById('loading');
      const button = document.getElementById('submit-btn');
      
      // Get form values
      const patientId = document.getElementById('patient-id').value;
      const patientName = document.getElementById('patient-name').value;
      const patientPhone = document.getElementById('patient-phone').value;
      const patientAge = document.getElementById('patient-age').value;
      const patientAddress = document.getElementById('patient-address').value;
      const patientCondition = document.getElementById('patient-condition').value;
      const wardOptions = document.getElementsByName('ward');
      
      let selectedWard = '';
      for (let i = 0; i < wardOptions.length; i++) {
        if (wardOptions[i].checked) {
          selectedWard = wardOptions[i].value;
          break;
        }
      }
      
      // Validate form (basic validation)
      if (!patientId || !patientName || !patientPhone || !patientAge || !patientAddress || !patientCondition || !selectedWard) {
        alert('Please fill in all required fields');
        return;
      }
      
      // Show loading animation
      loading.style.display = 'inline-block';
      button.textContent = 'Processing...';
      button.disabled = true;
      
      // Create patient data object
      const patientData = {
        patientId: patientId,
        patientName: patientName,
        patientPhone: patientPhone,
        patientAge: patientAge,
        patientAddress: patientAddress,
        patientCondition: patientCondition,
        ward: selectedWard
      };
      
      // Send data to API
      fetch('http://localhost:5000/api/register', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(patientData)
      })
      .then(response => response.json())
      .then(data => {
        loading.style.display = 'none';
        button.disabled = false;
        button.textContent = 'Allocate Bed';
        
        if (data.success) {
          // Show success message
          alert(data.message);
          // Reset form
          document.getElementById('patient-form').reset();
        } else {
          // Show error message
          alert('Error: ' + data.message);
        }
      })
      .catch(error => {
        loading.style.display = 'none';
        button.disabled = false;
        button.textContent = 'Allocate Bed';
        alert('Error: ' + error.message);
        console.error('Error:', error);
      });
    });
  </script>
</body>
</html>
